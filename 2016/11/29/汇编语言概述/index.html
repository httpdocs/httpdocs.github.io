<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<!--<![endif]-->

<head>
  <title>汇编语言概述 | What I Write</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="What I Write">
    <meta name="author" content="John Chang">
    <meta name="description" content="愿有岁月可回首 且以深情共白头" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="http://oh0ygta31.bkt.clouddn.com/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="What I Write" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
	
    <link rel="stylesheet" href="/highlightjs/vs.css" type="text/css">
    
    

    <!-- Custom stylesheet, (add custom styles here, always load last) -->
    <!-- Load our stylesheet for IE8 -->
    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->

  
  
  

  
  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            
        	<li>
        		<a class="sb-toggle-submenu">Categories<span class="sb-caret"></span></a>
            	<ul class="sb-submenu">
				  	
				    <li><a href="/categories/IDE/" class="animsition-link">IDE<small>(4)</small></a></li>
				    
				    <li><a href="/categories/git/" class="animsition-link">git<small>(3)</small></a></li>
				    
				    <li><a href="/categories/java/" class="animsition-link">java<small>(13)</small></a></li>
				    
				    <li><a href="/categories/linux/" class="animsition-link">linux<small>(6)</small></a></li>
				    
				    <li><a href="/categories/myql/" class="animsition-link">myql<small>(1)</small></a></li>
				    
				    <li><a href="/categories/mysql-linux/" class="animsition-link">mysql linux<small>(1)</small></a></li>
				    
				    <li><a href="/categories/python/" class="animsition-link">python<small>(11)</small></a></li>
				    
				    <li><a href="/categories/前端/" class="animsition-link">前端<small>(14)</small></a></li>
				    
				    <li><a href="/categories/大数据/" class="animsition-link">大数据<small>(3)</small></a></li>
				    
				    <li><a href="/categories/数据库/" class="animsition-link">数据库<small>(11)</small></a></li>
				    
				    <li><a href="/categories/数据结构和算法/" class="animsition-link">数据结构和算法<small>(7)</small></a></li>
				    
				    <li><a href="/categories/框架/" class="animsition-link">框架<small>(12)</small></a></li>
				    
				    <li><a href="/categories/科学上网/" class="animsition-link">科学上网<small>(1)</small></a></li>
				    
				    <li><a href="/categories/网络/" class="animsition-link">网络<small>(6)</small></a></li>
				    
				    <li><a href="/categories/计算机/" class="animsition-link">计算机<small>(15)</small></a></li>
				    
				</ul>
        	</li>
			
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="https://httpdocs.github.io/whatilike/" class="animsition-link">我喜欢的网站</a></li>
                    
                    <li><a href="https://httpdocs.github.io/resume/" class="animsition-link">我的简历</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            <li><a href="/about.html" class="animsition-link" title="about">ABOUT  ME</a></li>
           
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="https://t1.aixinxi.net/o_1c8u9b59q1m61bope081pin1u1sa.png-j.jpg" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">What I Write</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/httpdocs" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <li><a href="https://twitter.com/redpipeapple" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li>
                            
                            
                            
                            <li><a href="https://plus.google.com/u/0/105313890309653129166" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a></li>
                            
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->


      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2016-11-29T07:10:10.000Z" itemprop="datePublished">
          2016-11-29
      </time>
    
</span>
                <h1>汇编语言概述</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<p><code>汇编语言简介</code></p>
<p>汇编语言是一门直接与硬件相关的编程语言，它是一台机器的机器语言的符号语言。每一台计算机都有自己的指令系统，不一样的机器由于硬件的差异，采用的指令系统不一样，而汇编，也是每台机器都不太一样的，因为汇编就是用符合去代替指令中的操作码以及操作数。可以这样说，理解计算机CPU在某一架构（物理实现）下的工作原理，是学好汇编很重要的一点。</p>
<p>汇编语言的出现大大提高了编程效率，但是有一个问题就是不同CPU的指令集可能不同，这样就需要为不同的CPU编写不同的汇编程序。于是又出现了高级语言比如C，或者是后来的C++,Java,C#。 高级语言把多条汇编指令合成成为了一个表达式，并且去除了许多操作细节（比如堆栈操作，寄存器操作），而是以一种更直观的方式来编写程序，而面向对象的语言的出现使得程序编写更加符合我们的思维方式。我们不必把尽力放到低层的细节上，而更多的关注程序的本身的逻辑的实现。对于高级语言来说需要一个编译器来完成高级语言到汇编语言的转换。所以对比不同的CPU结构，只需要有不同编译器和汇编器就能使得我们的程序在不同CPU上都能运行了。对于目前来说，一般出现了新的指令，会有对应的新的汇编器和编译器。所以编译器可以把一些高级语言的表达式编译成新的汇编指令，这样对于高级来说不会有任何变化； 当然还有一种情况就是高级语言会增加新的语法来对应一些新的汇编语言和指令。但是这种情况出现的几率很小。所以如果编译器不支持新的指令，那么只有只用汇编会来实现了。</p>
<p>另外要说的一点是，对于C#和Java这种运行在虚拟机上的语言，编译过程有所不同。 对于C,C++的程序，生成的可执行文件，可以在兼容的计算机上直接运行。但是C#和JAVA这些语言则不同。他们编译过程是相似的，但是他们最终生成的并不是机器码，而是中间代码，对于C#而言叫IL代码，对于JAVA是字节码。所以C#,JAVA编译出来的文件并不能被执行。我们在使用.NET或JAVA时都需要安装.NET CLR或者JAVA虚拟机，以.NET为例，CLR实际是一个COM组件，当你点击一个.NET的EXE文件时，它和C++等不一样，不能直接被执行，而是有一个垫片程序来启动一个进程，并且初始化CLR组件。当CLR运行后，一个叫做JIT的编译器会吧EXE中的IL代码编译成对应平台的机器码，然后如同其他C++程序一样被执行。</p>
<p><code>CPU简介</code></p>
<ol>
<li>控制单元：控制单元是整个CPU的指挥控制中心，由指令寄存器IR(Instruction Register)、指令译码器ID(Instruction Decoder)和操作控制器OC(Operation Controller)等，对协调整个电脑有序工作极为重要。它根据用户预先编好的程序，依次从存储器中取出各条指令，放在指令寄存器IR中，通过指令译码(分析)确定应该进行什么操作，然后通过操作控制器OC，按确定的时序，向相应的部件发出微操作控制信号。操作控制器OC中主要包括节拍脉冲发生器、控制矩阵、时钟脉冲发生器、复位电路和启停电路等控制逻辑。 </li>
<li>运算单元：是运算器的核心。可以执行算术运算(包括加减乘数等基本运算及其附加运算)和逻辑运算(包括移位、逻辑测试或两个值比较)。相对控制单元而言，运算器接受控制单元的命令而进行动作，即运算单元所进行的全部操作都是由控制单元发出的控制信号来指挥的，所以它是执行部件。 </li>
<li>存储单元：包括CPU片内缓存和寄存器组，是CPU中暂时存放数据的地方，里面保存着那些等待处理的数据，或已经处理过的数据，CPU访问寄存器所用的时间要比访问内存的时间短。采用寄存器，可以减少CPU访问内存的次数，从而提高了CPU的工作速度。但因为受到芯片面积和集成度所限，寄存器组的容量不可能很大。寄存器组可分为专用寄存器和通用寄存器。专用寄存器的作用是固定的，分别寄存相应的数据。而通用寄存器用途广泛并可由程序员规定其用途，通用寄存器的数目因微处理器而异。</li>
</ol>
<p><img src="http://ogov1j6dy.bkt.clouddn.com/cpu.png" alt=""></p>
<p><code>寄存器</code></p>
<p>首先寄存器是CPU里面的重要的部件，简单来说，就是个存储部件，速度很快，造价高，所以只有这类硬件在计算机里比较少。寄存器是CPU里面很重要的一个部件，通常在CPU里面都有一个寄存器组，里面放着有通用寄存器，专用寄存器等（因CPU而异）。</p>
<p>这个是80x86处理器架构下的寄存器。<br><img src="http://ogov1j6dy.bkt.clouddn.com/jicunqi1.jpg" alt=""></p>
<p>这个是支持64位的cpu里的寄存器。<br><img src="http://ogov1j6dy.bkt.clouddn.com/jicunqi2.png" alt=""></p>
<p>后来的pentium4及更高型号处理器增加了8个通用寄存器实现更多功能<br><img src="http://ogov1j6dy.bkt.clouddn.com/jicunqi3.png" alt=""></p>
<p><code>寻址方式</code></p>
<p>我们知道，寄存器里面一开始是没有东西的，由CPU的控制器决定让CPU去哪里去数据，进行什么操作。既然要取数据，就会涉及寻址。所谓寻址，就是CPU要去内存的哪个地址去取数据。在80x86下，一般有</p>
<ul>
<li>立即数寻址</li>
<li>直接寻址</li>
<li>寄存器寻址</li>
<li>寄存器间接寻址</li>
<li>基址变址寻址<br>等等</li>
</ul>
<p>在这里简单说一下实现寻址，主要是通过段寄存器CS,DS,SS,ES()来实现,一般由这些CS，DS，SS来指向起始位置，然后由其他指针寄存器去实现代码数据的移动变换（我的理解就是内存的寻址）。举例子，比如CS来说，一般CS指向正在执行的代码段的开始位置，然后会有搭档IP（指令指针）去实现指向要执行的下一条指令。然后是SS指针，SS存放堆栈段栈底，然后SP指向栈顶（入栈出栈SP自加自减），再搭配BP指针（读取任意内存位置的堆栈数据）。</p>
<blockquote>
<p>利用寄存器可以实现CPU内部的寻址机制，我们就可以利用汇编找到操作数了。</p>
</blockquote>
<p><code>CPU指令集</code></p>
<p>每个CPU都有自己的指令集合，汇编就是这些指令的符号表示。</p>
<p>一条指令往往是由操作码和操作数组成。利用寄存器和寻址机制，我们搞定了操作数。那么操作码呢？</p>
<p>在汇编语言里，也有自己的语法：</p>
<ul>
<li>基本数据操作</li>
<li>分支结构</li>
<li>循环结构</li>
<li>子程序结构（高级语言里的方法）</li>
<li>宏</li>
<li>以及一些高级汇编语言技术。</li>
</ul>
<p>然后汇编语言的更多相关细节就不展开详细说了，像调用系统中断，BIOS中断，以及DOS中断等。（中断程序就是写好了的一个函数，中断向量表存放着这个函数的入口地址）</p>
<p>总之汇编就是把我们计算机里面的机器操作指令转换为了便于记忆的符号标识。学习汇编可以让我们更清楚得理解程序是怎么在CPU内部运行的。</p>
<p>然后通过一段简单的汇编代码体会一下汇编是如何利用寄存器和寻址机制进行工作的。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"></div><div class="line">DATAS SEGMENT ;定义数据段，开始</div><div class="line"></div><div class="line">    str_tip db &apos;when input xiaoxie word ,change to daxie&apos;,0dh,0ah,24h  ;str_tip以db字节存储字符串</div><div class="line">    </div><div class="line">    nextLine db 0dh,0ah,24h  ;定义一个换行符</div><div class="line">    </div><div class="line">    str_exit db &apos;welcome next time ,i will be waiting for you!&apos;  ;离开提示符</div><div class="line"></div><div class="line">DATAS ENDS  ;数据段，结束</div><div class="line"></div><div class="line">STACKS SEGMENT ;定义堆栈段，开始</div><div class="line"></div><div class="line">    db 30h dup(?)</div><div class="line"></div><div class="line">    top label word</div><div class="line"></div><div class="line">STACKS ENDS ;结束开始</div><div class="line"></div><div class="line">CODES SEGMENT ;定义代码段，开始</div><div class="line"></div><div class="line">    ASSUME CS:CODES,DS:DATAS,SS:STACKS ;声明CODES，DATAS，</div><div class="line">    STACKS，存放的寄存器</div><div class="line">    </div><div class="line">START:</div><div class="line">    MOV AX,DATAS </div><div class="line">    MOV DS,AX</div><div class="line">    MOV AX,STACKS</div><div class="line">    MOV SS,AX</div><div class="line">    LEA SP,TOP  ;取得地址，并存放进相应段寄存器</div><div class="line">    </div><div class="line">    mov dx,offset str_tip  ;中断程序的参数（方法参数）</div><div class="line">    mov ah,9 ;中断程序的类型（具体哪个方法）</div><div class="line">    int 21h ;调用DOS系统中断程序</div><div class="line">    </div><div class="line">xunhuan:</div><div class="line">    mov ah,1</div><div class="line">    int 21h ;调用1号函数，没有参数。</div><div class="line">    </div><div class="line">    push ax ;保留寄存器的值，因为下一步的运算会用到该AX寄存器，防止被破坏了。</div><div class="line">	mov dx,offset nextLine </div><div class="line">	mov ah,9</div><div class="line">	int 21h ;也是调用DOS系统中断</div><div class="line">	</div><div class="line">    pop ax ;系统中断调用完后，回复刚才那个函数执行时候被推进栈内的上下文相关的寄存器。因为刚才那个过程（即中断，也就是函数）只用来AX，也只推进了AX的值进栈，所以我们恢复刚才的环境的时候只需要pop出栈的值到AX就可。当然你也刚才把所有寄存器都存进栈，这时就把所有寄存器都弹出栈，不过很明显这样会浪费栈资源。</div><div class="line">    </div><div class="line">    cmp al,0dh</div><div class="line">    je exit</div><div class="line">    cmp al,&apos;a&apos;</div><div class="line">    jb output</div><div class="line">    cmp al,&apos;z&apos;</div><div class="line">    ja output  ;简单的分支结构，要完全理解的话，要看书。</div><div class="line">      </div><div class="line">    sub al,20h</div><div class="line">output:</div><div class="line">	mov dl,al</div><div class="line">	mov ah,2</div><div class="line">	int 21h</div><div class="line">	</div><div class="line">	mov dx,offset nextLine </div><div class="line">	mov ah,9</div><div class="line">	int 21h</div><div class="line">	jmp xunhuan</div><div class="line">    </div><div class="line">exit:    </div><div class="line">	mov dx,offset str_exit</div><div class="line">	mov ah,9</div><div class="line">	int 21h</div><div class="line">	</div><div class="line">    MOV AH,4CH</div><div class="line">    INT 21H  ;调用程序结束的函数，相当于return。</div><div class="line">CODES ENDS</div><div class="line">    END START ;程序结束</div></pre></td></tr></table></figure>
<p><a href="http://ogov1j6dy.bkt.clouddn.com/%E6%B1%87%E7%BC%96.zip" target="_blank" rel="external">更多文件点击此处</a></p>

            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="pagination" role="pagination">
    
    <a class="pull-left" href="/2016/11/29/堆栈理解/" style="float: left;">
        ← 堆栈理解
    </a>
    
    
    <a class="pull-right" href="/2016/11/28/数据结构与算法/">
        数据结构和算法认识 →
    </a>
    
</nav>

        <div class="duoshuo"></div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By John Chang. All Rights Reserved.
                </p>
                <p>Theme By Kieran</p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/httpdocs" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://twitter.com/redpipeapple" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                    
                    
                    
                    <li><a href="https://plus.google.com/u/0/105313890309653129166" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a>&nbsp;</li>
                    
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
        
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };
    
    resizeHero();
    
    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/jquery.flexslider-min.js"></script><!-- Flexslider plugin -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->

<!-- Initiate flexslider plugin -->
<script type="text/javascript">
    $(document).ready(function($) {
      $('.flexslider').flexslider({
        animation: "fade",
        prevText: "",
        nextText: "",
        directionNav: true
      });
    });
</script>

</body>
</html>
